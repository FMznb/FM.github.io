<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>jQuery动画</title>
    <script src="../js/jquery-3.7.1.min.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #game-container {
            position: relative;
            width: 100%;
            height: 100vh;
            background: black;
        }
        .character {
            position: absolute;
        }
        #player2 {
            display: none;
        }
        #boss {
            bottom: 10px;
            right: 10px;
        }
        #player_big {
            top: 10px;
            right: 10px;
        }
        /* 为商人添加鼠标悬停时的文本样式 */
        .merchant-text {
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
        }
        .boss-text, .merchant-text {
            display: none;
            position: absolute;
            left: 50%;
            bottom: 100%;
            margin-bottom: 20px;
            color: white;
            font-weight: bold;
            transform: translateX(-50%);
            white-space: nowrap;
            pointer-events: none; /* 允许鼠标事件通过文本 */
        }
    </style>
</head>
<body>
<div id="game-container">
    <img id="pet" class="character" src="../img/pet.gif" alt="宠物">
    <img id="player_right" class="character" src="../img/player_right.gif" alt="人物">
    <img id="player_big" class="character" src="../img/player_big.gif" alt="商人">
    <img id="boss" class="character" src="../img/player1_big.gif" alt="boss">
    <img id="player2" class="character" src="../img/player2.gif" alt="变身">
    <div class="boss-text">我是boss</div>
    <div class="merchant-text">我是商人</div>
</div>
<script>
    $(document).ready(function(){
        var gameContainer = $("#game-container");
        var player = $("#player_right");
        var player2 = $("#player2");
        var pet = $("#pet");
        var boss = $("#boss");
        var bossText = $(".boss-text");
        var merchant = $("#player_big");
        var merchantText = $(".merchant-text");
        var activeCharacter = player; // 当前活动的角色

        // 鼠标悬停在boss上时显示文本
        boss.hover(function(){
            bossText.css('bottom', boss.height() + 'px'); // 将文本定位
            bossText.show();
        }, function(){
            bossText.hide();
        });

        // 鼠标悬停在商人上时显示文本
        merchant.hover(function(){
            merchantText.css('bottom', merchant.height() + 'px'); // 将文本定位
            merchantText.show();
        }, function(){
            merchantText.hide();
        });

        // 移动角色到指定位置
        function moveCharacterTo(character, x, y, callback) {
            character.stop().animate({left: x, top: y}, "slow", callback);
            // 更新宠物的位置，使其保持在角色的左下角
            pet.stop().animate({
                left: character.position().left + character.width(),
                top: character.position().top + character.height()
            }, "slow", function() {
                // 确保宠物在角色的左下角，紧挨着角色
                pet.css({
                    left: character.position().left + character.width(),
                    top: character.position().top + character.height()
                });
            });
        }

        // 鼠标点击移动当前活动的角色
        gameContainer.on("click", function(event){
            var newX = event.pageX - gameContainer.offset().left - activeCharacter.width()/2;
            var newY = event.pageY - gameContainer.offset().top - activeCharacter.height()/2;
            moveCharacterTo(activeCharacter, newX, newY);
        });

        // 双击变身
        player.on("dblclick", function(){
            var newX = player.position().left;
            var newY = player.position().top;
            player.hide();
            player2.css({left: newX, top: newY}).show();
            activeCharacter = player2; // 将当前活动的角色切换为变身后的角色
        });

        // 双击变身后的角色变回原始角色
        player2.on("dblclick", function(){
            var newX = player2.position().left;
            var newY = player2.position().top;
            player2.hide();
            player.css({left: newX, top: newY}).show();
            activeCharacter = player; // 将当前活动的角色切换回原始角色
        });
    });

</script>
</body>
</html>
